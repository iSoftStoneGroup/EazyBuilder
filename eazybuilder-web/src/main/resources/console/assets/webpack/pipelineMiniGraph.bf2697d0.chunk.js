(this.webpackJsonp=this.webpackJsonp||[]).push([[420],{HXu9:function(t,e,i){"use strict";var n=i("bOix");e.a={data:()=>({remainingTime:Object(n.j)(0),remainingTimeIntervalId:null}),mounted(){this.startRemainingTimeInterval()},beforeDestroy(){this.remainingTimeIntervalId&&clearInterval(this.remainingTimeIntervalId)},computed:{isDelayedJob(){var t,e;return(null===(t=this.job)||void 0===t?void 0:t.scheduled)||(null===(e=this.job)||void 0===e?void 0:e.scheduledAt)},scheduledTime(){return this.job.scheduled_at||this.job.scheduledAt}},watch:{isDelayedJob(){this.startRemainingTimeInterval()}},methods:{startRemainingTimeInterval(){var t=this;this.remainingTimeIntervalId&&clearInterval(this.remainingTimeIntervalId),this.isDelayedJob&&(this.updateRemainingTime(),this.remainingTimeIntervalId=setInterval((function(){return t.updateRemainingTime()}),1e3))},updateRemainingTime(){const t=Object(n.c)(this.scheduledTime);this.remainingTime=Object(n.j)(t)}}}},K3k0:function(t,e,i){"use strict";i.r(e);var n=i("s1D3"),o=i("FkSe"),s=i("Yyc1"),a=i("LLbv"),r=i("XRO8"),l=i("2ibD"),c=i("/lV4"),p=i("s5BM"),d=i("MV2A"),u=i("HXu9"),m=i("GuZl"),h=i("71Sp"),g=i("jltb"),b=i("fn5V"),v={hoverClass:"gl-shadow-x0-y0-b3-s1-blue-500",components:{ActionComponent:g.a,JobNameComponent:b.a,GlLink:d.a},directives:{GlTooltip:a.a},mixins:[u.a],props:{job:{type:Object,required:!0},cssClassJobName:{type:String,required:!1,default:""},dropdownLength:{type:Number,required:!1,default:1/0},jobHovered:{type:String,required:!1,default:""},pipelineExpanded:{type:Object,required:!1,default:function(){return{}}},pipelineId:{type:Number,required:!1,default:-1}},computed:{boundary(){return 1===this.dropdownLength?"viewport":"scrollParent"},detailsPath(){return this.status.details_path},hasDetails(){return this.status.has_details},status(){return this.job&&this.job.status?this.job.status:{}},tooltipText(){const t=[],{name:e}=this.job;e&&t.push(e);const{tooltip:i}=this.status;return e&&i&&t.push("-"),i&&(this.isDelayedJob?t.push(Object(c.f)(i,{remainingTime:this.remainingTime})):t.push(i)),t.join(" ")},hasAction(){return this.job.status&&this.job.status.action&&this.job.status.action.path},relatedDownstreamHovered(){return this.job.name===this.jobHovered},relatedDownstreamExpanded(){return this.job.name===this.pipelineExpanded.jobName&&this.pipelineExpanded.expanded},jobClasses(){return this.relatedDownstreamHovered||this.relatedDownstreamExpanded?"".concat(this.$options.hoverClass," ").concat(this.cssClassJobName):this.cssClassJobName}},errorCaptured(t,e,i){Object(h.d)("pipelines_job_item","pipelines_job_item error: ".concat(t,", info: ").concat(i))},methods:{hideTooltips(){this.$root.$emit(m.b)},pipelineActionRequestComplete(){this.$emit("pipelineActionRequestComplete")}}},j=i("tBpV"),w=Object(j.a)(v,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ci-job-component gl-display-flex gl-align-items-center gl-justify-content-space-between",attrs:{"data-qa-selector":"job_item_container"}},[t.hasDetails?i("gl-link",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:{boundary:"viewport",placement:"bottom",customClass:"gl-pointer-events-none"},expression:"{\n      boundary: 'viewport',\n      placement: 'bottom',\n      customClass: 'gl-pointer-events-none',\n    }"}],staticClass:"js-pipeline-graph-job-link qa-job-link menu-item gl-text-gray-900 gl-active-text-decoration-none gl-focus-text-decoration-none gl-hover-text-decoration-none",class:t.jobClasses,attrs:{href:t.detailsPath,title:t.tooltipText,"data-testid":"job-with-link"},on:{click:function(e){return e.stopPropagation(),t.hideTooltips(e)},mouseout:t.hideTooltips}},[i("job-name-component",{attrs:{name:t.job.name,status:t.job.status,"icon-size":24}})],1):i("div",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:{boundary:t.boundary,placement:"bottom",customClass:"gl-pointer-events-none"},expression:"{ boundary, placement: 'bottom', customClass: 'gl-pointer-events-none' }"}],staticClass:"js-job-component-tooltip non-details-job-component menu-item",class:t.jobClasses,attrs:{title:t.tooltipText,"data-testid":"job-without-link"},on:{mouseout:t.hideTooltips}},[i("job-name-component",{attrs:{name:t.job.name,status:t.job.status,"icon-size":24}})],1),t._v(" "),t.hasAction?i("action-component",{attrs:{"tooltip-text":t.status.action.title,link:t.status.action.path,"action-icon":t.status.action.icon,"data-qa-selector":"action_button"},on:{pipelineActionRequestComplete:t.pipelineActionRequestComplete}}):t._e()],1)}),[],!1,null,null,null).exports,f={components:{GlIcon:n.a,GlLoadingIcon:o.a,GlDropdown:s.a,JobItem:w},directives:{GlTooltip:a.a},props:{stage:{type:Object,required:!0},updateDropdown:{type:Boolean,required:!1,default:!1},isMergeTrain:{type:Boolean,required:!1,default:!1}},data:()=>({isLoading:!1,dropdownContent:[]}),computed:{triggerButtonClass(){return"ci-status-icon-".concat(this.stage.status.group)},borderlessIcon(){return"".concat(this.stage.status.icon,"_borderless")}},watch:{updateDropdown(){this.updateDropdown&&this.isDropdownOpen()&&!this.isLoading&&this.fetchJobs()}},methods:{onShowDropdown(){p.a.$emit("clickedDropdown"),this.isLoading=!0,this.fetchJobs()},fetchJobs(){var t=this;l.a.get(this.stage.dropdown_path).then((function(e){let{data:i}=e;t.dropdownContent=i.latest_statuses,t.isLoading=!1})).catch((function(){t.$refs.dropdown.hide(),t.isLoading=!1,Object(r.c)(Object(c.a)("Something went wrong on our end."))}))},isDropdownOpen(){return this.$el.classList.contains("show")},pipelineActionRequestComplete(){this.$refs.dropdown.hide(),this.$emit("pipelineActionRequestComplete")}}},C={components:{PipelineStage:Object(j.a)(f,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("gl-dropdown",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.hover.ds0",modifiers:{hover:!0,ds0:!0}}],ref:"dropdown",attrs:{"data-testid":"mini-pipeline-graph-dropdown",title:t.stage.title,variant:"link",lazy:!0,"popper-opts":{placement:"bottom"},"toggle-class":["mini-pipeline-graph-dropdown-toggle",t.triggerButtonClass],"menu-class":"mini-pipeline-graph-dropdown-menu"},on:{show:t.onShowDropdown},scopedSlots:t._u([{key:"button-content",fn:function(){return[i("span",{staticClass:"gl-pointer-events-none"},[i("gl-icon",{attrs:{name:t.borderlessIcon}})],1)]},proxy:!0}])},[t._v(" "),t.isLoading?i("gl-loading-icon"):i("ul",{staticClass:"js-builds-dropdown-list scrollable-menu",attrs:{"data-testid":"mini-pipeline-graph-dropdown-menu-list"}},[t._l(t.dropdownContent,(function(e){return i("li",{key:e.id},[i("job-item",{attrs:{"dropdown-length":t.dropdownContent.length,job:e,"css-class-job-name":"mini-pipeline-graph-dropdown-item"},on:{pipelineActionRequestComplete:t.pipelineActionRequestComplete}})],1)})),t._v(" "),t.isMergeTrain?[i("li",{staticClass:"gl-new-dropdown-divider",attrs:{role:"presentation"}},[i("hr",{staticClass:"dropdown-divider",attrs:{role:"separator","aria-orientation":"horizontal"}})]),t._v(" "),i("li",[i("div",{staticClass:"gl-display-flex gl-align-items-center",attrs:{"data-testid":"warning-message-merge-trains"}},[i("div",{staticClass:"menu-item gl-font-sm gl-text-gray-300!"},[t._v("\n            "+t._s(t.s__("Pipeline|Merge train pipeline jobs can not be retried"))+"\n          ")])])])]:t._e()],2)],1)}),[],!1,null,null,null).exports},props:{stages:{type:Array,required:!0},updateDropdown:{type:Boolean,required:!1,default:!1},stagesClass:{type:[Array,Object,String],required:!1,default:""},isMergeTrain:{type:Boolean,required:!1,default:!1}},methods:{onPipelineActionRequestComplete(){this.$emit("pipelineActionRequestComplete")}}},y=Object(j.a)(C,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{"data-testid":"pipeline-mini-graph"}},t._l(t.stages,(function(e){return i("div",{key:e.name,staticClass:"stage-container dropdown",class:t.stagesClass},[i("pipeline-stage",{attrs:{stage:e,"update-dropdown":t.updateDropdown,"is-merge-train":t.isMergeTrain},on:{pipelineActionRequestComplete:t.onPipelineActionRequestComplete}})],1)})),0)}),[],!1,null,null,null);e.default=y.exports},fn5V:function(t,e,i){"use strict";var n={components:{ciIcon:i("8zNS").a},props:{name:{type:String,required:!0},status:{type:Object,required:!0},iconSize:{type:Number,required:!1,default:16}}},o=i("tBpV"),s=Object(o.a)(n,(function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"ci-job-name-component mw-100 gl-display-flex gl-align-items-center"},[e("ci-icon",{staticClass:"gl-line-height-0",attrs:{size:this.iconSize,status:this.status}}),this._v(" "),e("span",{staticClass:"gl-text-truncate mw-70p gl-pl-3 gl-display-inline-block"},[this._v("\n    "+this._s(this.name)+"\n  ")])],1)}),[],!1,null,null,null);e.a=s.exports},jltb:function(t,e,i){"use strict";var n=i("s1D3"),o=i("4lAS"),s=i("FkSe"),a=i("LLbv"),r=i("XRO8"),l=i("2ibD"),c=i("GuZl"),p=i("0AwG"),d=i("/lV4"),u=i("71Sp"),m={components:{GlIcon:n.a,GlButton:o.a,GlLoadingIcon:s.a},directives:{GlTooltip:a.a},props:{tooltipText:{type:String,required:!0},link:{type:String,required:!0},actionIcon:{type:String,required:!0}},data:()=>({isDisabled:!1,isLoading:!1}),computed:{cssClass(){const t=Object(p.h)(this.actionIcon);return"".concat(t," js-icon-").concat(t)}},errorCaptured(t,e,i){Object(u.d)("action_component","error: ".concat(t,", info: ").concat(i))},methods:{onClickAction(){var t=this;this.$root.$emit(c.b,"js-ci-action-".concat(this.link)),this.isDisabled=!0,this.isLoading=!0,l.a.post("".concat(this.link,".json")).then((function(){t.isDisabled=!1,t.isLoading=!1,t.$emit("pipelineActionRequestComplete")})).catch((function(e){t.isDisabled=!1,t.isLoading=!1,Object(u.d)("action_component",e),Object(r.c)(Object(d.a)("An error occurred while making the request."))}))}}},h=i("tBpV"),g=Object(h.a)(m,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:{boundary:"viewport"},expression:"{ boundary: 'viewport' }"}],staticClass:"js-ci-action gl-ci-action-icon-container ci-action-icon-container ci-action-icon-wrapper gl-display-flex gl-align-items-center gl-justify-content-center",class:t.cssClass,attrs:{id:"js-ci-action-"+t.link,title:t.tooltipText,disabled:t.isDisabled},on:{click:function(e){return e.stopPropagation(),t.onClickAction(e)}}},[t.isLoading?i("gl-loading-icon",{staticClass:"js-action-icon-loading"}):i("gl-icon",{staticClass:"gl-mr-0!",attrs:{name:t.actionIcon,"aria-label":t.actionIcon}})],1)}),[],!1,null,null,null);e.a=g.exports},s5BM:function(t,e,i){"use strict";var n=i("7xOh");e.a=Object(n.a)()}}]);
//# sourceMappingURL=pipelineMiniGraph.bf2697d0.chunk.js.map