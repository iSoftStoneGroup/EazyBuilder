(this.webpackJsonp=this.webpackJsonp||[]).push([[92],{"/ode":function(t,e,n){"use strict";n.d(e,"a",(function(){return k})),n.d(e,"b",(function(){return x}));n("jaBk"),n("S26F"),n("pBsb"),n("+xeR"),n("orcL");var i=n("d+lS"),s=n.n(i),o=n("eVUo"),r=n("EmJ/"),a=n.n(r),l=n("06tH"),c=n.n(l),d=n("tDP3"),u=n("NmEs"),h=n("nc9B"),m=n("XRO8"),f=n("2ibD"),p=n("1OWu"),g=n("/lV4");const v="animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",b="transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",j=/(?:, and | and |, )/,y={activity:"Activity",people:"People",nature:"Nature",food:"Food",travel:"Travel",objects:"Objects",symbols:"Symbols",flags:"Flags"},w="is-visible",E="is-rendered";class k{constructor(t){this.emoji=t,this.eventListeners=[],this.toggleButtonSelector=".js-add-award",this.menuClass="js-award-emoji-menu"}bindEvents(){var t=this;const e=this.targetContainerEl?a()(this.targetContainerEl):a()(document);this.registerEventListener("one",e,"mouseenter focus",this.toggleButtonSelector,"mouseenter focus",(function(){0===a()(".".concat(t.menuClass)).length&&requestAnimationFrame((function(){t.createEmojiMenu()}))})),this.registerEventListener("on",e,"click",this.toggleButtonSelector,(function(e){e.stopPropagation(),e.preventDefault(),t.showEmojiMenu(a()(e.currentTarget))})),this.registerEventListener("on",a()("html"),"click",(function(e){a()(e.target).closest(".".concat(t.menuClass)).length||(a()(".js-awards-block.current").removeClass("current"),a()(".".concat(t.menuClass)).is(":visible")&&(a()("".concat(t.toggleButtonSelector,".is-active")).removeClass("is-active"),t.hideMenuElement(a()(".".concat(t.menuClass)))))}));const n=".js-awards-block .js-emoji-btn, .".concat(this.menuClass," .js-emoji-btn");this.registerEventListener("on",e,"click",n,(function(e){e.preventDefault();const n=a()(e.currentTarget),i=n.find("gl-emoji"),s=n.find(".icon"),o=(i.length?i:s).data("name");n.closest(".js-awards-block").addClass("current"),t.addAward(t.getVotesBlock(),t.getAwardUrl(),o)}))}registerEventListener(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"on",e=arguments.length>1?arguments[1]:void 0;for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];e[t].call(e,...i),this.eventListeners.push({element:e,args:i})}showEmojiMenu(t){var e=this;t.hasClass("js-note-emoji")?t.closest(".note").find(".js-awards-block").addClass("current"):t.closest(".js-awards-block").addClass("current");const n=a()(".".concat(this.menuClass));n.length?n.is(".is-visible")?(t.removeClass("is-active"),this.hideMenuElement(n),a()(".js-emoji-menu-search").blur()):(t.addClass("is-active"),this.positionMenu(n,t),this.showMenuElement(n),a()(".js-emoji-menu-search").focus()):(t.addClass("is-loading is-active"),this.createEmojiMenu((function(){const n=a()(".".concat(e.menuClass));return t.removeClass("is-loading"),e.positionMenu(n,t),setTimeout((function(){e.showMenuElement(n),a()(".js-emoji-menu-search").focus()}),200)})))}createEmojiMenu(t){if(this.isCreatingEmojiMenu)return;this.isCreatingEmojiMenu=!0;const e=this.emoji.getEmojiCategoryMap(),n=Object.keys(e)[0],i=e[n],s=this.renderCategory(y[n],i),o=this.getFrequentlyUsedEmojis();let r="";o.length>0&&(r=this.renderCategory("Frequently used",o,{menuListClass:"frequent-emojis"}));const a='\n      <div class="emoji-menu '.concat(this.menuClass,'">\n        <input type="text" name="emoji-menu-search" value="" class="js-emoji-menu-search emoji-search search-input form-control" placeholder="Search emoji" />\n\n        <div class="emoji-menu-content">\n          ').concat(r,"\n          ").concat(s,"\n        </div>\n      </div>\n    ");(this.targetContainerEl?this.targetContainerEl:document.body).insertAdjacentHTML("beforeend",a),this.addRemainingEmojiMenuCategories(),this.setupSearch(),t&&t()}addRemainingEmojiMenuCategories(){var t=this;if(this.isAddingRemainingEmojiMenuCategories)return;this.isAddingRemainingEmojiMenuCategories=!0;const e=this.emoji.getEmojiCategoryMap(),n=document.querySelector(".".concat(this.menuClass)),i=n.querySelector(".emoji-menu-content");Object.keys(e).slice(1).reduce((function(n,s){return n.then((function(){return new Promise((function(n){const o=e[s],r=t.renderCategory(y[s],o);requestAnimationFrame((function(){i.insertAdjacentHTML("beforeend",r),n()}))}))}))}),Promise.resolve()).then((function(){n&&n.dispatchEvent(new CustomEvent("build-emoji-menu-finish"))})).catch((function(t){throw i.insertAdjacentHTML("beforeend","<p>We encountered an error while adding the remaining categories</p>"),new Error("Error occurred in addRemainingEmojiMenuCategories: ".concat(t.message))}))}renderCategory(t,e){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return'\n      <h5 class="emoji-menu-title">\n        '.concat(t,'\n      </h5>\n      <ul class="clearfix emoji-menu-list ').concat(i.menuListClass||"",'">\n        ').concat(e.map((function(t){return'\n          <li class="emoji-menu-list-item">\n            <button class="emoji-menu-btn text-center js-emoji-btn" type="button">\n              '.concat(n.emoji.glEmojiTag(t,{sprite:!0}),"\n            </button>\n          </li>\n        ")})).join("\n"),"\n      </ul>\n    ")}positionMenu(t,e){if(this.targetContainerEl)return t.css({top:"".concat(e.outerHeight(),"px")});const n=e.data("position"),i={top:"".concat(e.offset().top+e.outerHeight(),"px")};return"xs"===o.b.getBreakpointSize()||"sm"===o.b.getBreakpointSize()?i.left="5%":"right"===n?(i.left="".concat(e.offset().left-t.outerWidth()+20,"px"),t.addClass("is-aligned-right")):(i.left="".concat(e.offset().left,"px"),t.removeClass("is-aligned-right")),t.css(i)}addAward(t,e,n,i,s){var o=this;const r=t.closest(".js-noteable-awards").length;if(Object(p.f)()&&!r){const e=t.attr("id").replace("note_","");this.hideMenuElement(a()(".".concat(this.menuClass))),a()("".concat(this.toggleButtonSelector,".is-active")).removeClass("is-active");const i=new CustomEvent("toggleAward",{detail:{awardName:n,noteId:e}});document.querySelector(".js-vue-notes-event").dispatchEvent(i)}const l=this.emoji.normalizeEmojiName(n),c=this.findEmojiIcon(t,l).parent();return this.postEmoji(c,e,l,(function(){return o.addAwardToEmojiBar(t,l,i),"function"==typeof s?s():void 0})),this.hideMenuElement(a()(".".concat(this.menuClass))),a()("".concat(this.toggleButtonSelector,".is-active")).removeClass("is-active")}addAwardToEmojiBar(t,e,n){(n||null===n)&&this.checkMutuality(t,e),this.addEmojiToFrequentlyUsedList(e);const i=this.emoji.normalizeEmojiName(e),s=this.findEmojiIcon(t,i).parent();if(s.length>0)if(this.isActive(s))this.decrementCounter(s,i);else{const e=s.find(".js-counter");e.text(parseInt(e.text(),10)+1),s.addClass("active"),this.addYouToUserList(t,i),this.animateEmoji(s)}else t.removeClass("hidden"),this.createEmoji(t,i)}getVotesBlock(){if(Object(p.f)()){const t=a()("".concat(this.toggleButtonSelector,".is-active")).closest(".note.timeline-entry");if(t.length)return t}const t=a()(".js-awards-block.current");let e=t;return 0===t.length&&(e=a()(".js-awards-block").eq(0)),e}getAwardUrl(){return this.getVotesBlock().data("awardUrl")}checkMutuality(t,e){const n=this.getAwardUrl();if("thumbsup"===e||"thumbsdown"===e){const i="thumbsup"===e?"thumbsdown":"thumbsup";t.find('[data-name="'.concat(i,'"]')).parent().hasClass("active")&&this.addAward(t,n,i,!1)}}isActive(t){return t.hasClass("active")}decrementCounter(t,e){const n=a()(".js-counter",t),i=parseInt(n.text(),10);return i>1?(n.text(i-1),this.removeYouFromUserList(t)):"thumbsup"===e||"thumbsdown"===e?(Object(h.b)(t),n.text("0"),this.removeYouFromUserList(t),t.parents(".note").length&&this.removeEmoji(t)):this.removeEmoji(t),t.removeClass("active")}removeEmoji(t){Object(h.b)(t),t.remove();const e=this.getVotesBlock();0===e.find(".js-emoji-btn").length&&e.addClass("hidden")}getAwardTooltip(t){return t.attr("data-original-title")||t.attr("data-title")||""}toSentence(t){let e;return e=t.length<=2?t.join(" and "):"".concat(t.slice(0,-1).join(", "),", and ").concat(t[t.length-1])}removeYouFromUserList(t){const e=t,n=this.getAwardTooltip(e).split(j);return n.splice(n.indexOf("You"),1),e.closest(".js-emoji-btn").removeData("title").removeAttr("data-title").removeAttr("data-original-title").attr("title",this.toSentence(n)),Object(h.c)(e),e}addYouToUserList(t,e){const n=this.findEmojiIcon(t,e).parent(),i=this.getAwardTooltip(n);let s=[];return i&&(s=i.trim().split(j)),s.unshift("You"),n.attr("title",this.toSentence(s)),Object(h.c)(n),n}createAwardButtonForVotesBlock(t,e){const n='\n      <button class="gl-button btn btn-default award-control js-emoji-btn has-tooltip active" title="You">\n        '.concat(this.emoji.glEmojiTag(e),'\n        <span class="award-control-text js-counter">1</span>\n      </button>\n    '),i=a()(n);i.insertBefore(t.find(".js-award-holder")).find(".emoji-icon").data("name",e),this.animateEmoji(i),t.removeClass("current")}animateEmoji(t){t.addClass("pulse animated once short"),this.registerEventListener("on",t,v,(function(t){a()(t.currentTarget).removeClass("pulse animated once short")}))}createEmoji(t,e){var n=this;a()(".".concat(this.menuClass)).length&&this.createAwardButtonForVotesBlock(t,e),this.createEmojiMenu((function(){n.createAwardButtonForVotesBlock(t,e)}))}postEmoji(t,e,n,i){f.a.post(e,{name:n}).then((function(t){let{data:e}=t;e.ok&&i()})).catch((function(){return Object(m.c)(Object(g.a)("Something went wrong on our end."))}))}findEmojiIcon(t,e){return t.find('.js-emoji-btn [data-name="'.concat(e,'"]'))}scrollToAwards(){Object(u.Q)(".awards",{offset:-110})}addEmojiToFrequentlyUsedList(t){this.emoji.isEmojiNameValid(t)&&(this.frequentlyUsedEmojis=s()(this.getFrequentlyUsedEmojis().concat(t)),c.a.set("frequently_used_emojis",this.frequentlyUsedEmojis.join(","),{expires:365}))}getFrequentlyUsedEmojis(){var t=this;return this.frequentlyUsedEmojis||function(){const e=s()((c.a.get("frequently_used_emojis")||"").split(","));return t.frequentlyUsedEmojis=e.filter((function(e){return t.emoji.isEmojiNameValid(e)})),t.frequentlyUsedEmojis}()}setupSearch(){var t=this;const e=a()(".js-emoji-menu-search");this.registerEventListener("on",e,"input",(function(e){const n=a()(e.target).val().trim();t.searchEmojis(n)}));const n=a()(".".concat(this.menuClass));this.registerEventListener("on",n,b,(function(e){e.target===e.currentTarget&&t.searchEmojis("")}))}searchEmojis(t){if(a()(".js-emoji-menu-search").val(t),a()("ul.emoji-menu-search, h5.emoji-search-title").remove(),t.length>0){const e=a()('<h5 class="emoji-search-title"/>').text("Search results"),n=this.findMatchingEmojiElements(t).show(),i=a()("<ul>").addClass("emoji-menu-list emoji-menu-search").append(n);a()(".emoji-menu-content ul, .emoji-menu-content h5").hide(),a()(".emoji-menu-content").append(e).append(i)}else a()(".emoji-menu-content").children().show()}findMatchingEmojiElements(t){const e=this.emoji.searchEmoji(t).map((function(t){return t.emoji.name}));return a()(".emoji-menu-list:not(.frequent-emojis) [data-name]").filter((function(t,n){return e.indexOf(n.dataset.name)>=0})).closest("li").clone()}showMenuElement(t){return t.addClass(E),Promise.resolve().then((function(){return t.addClass(w)}))}hideMenuElement(t){t.on(b,(function(e){e.currentTarget===e.target&&t.removeClass(E).off(b)})),t.removeClass(w)}destroy(){this.eventListeners.forEach((function(t){t.element.off.call(t.element,...t.args)})),a()(".".concat(this.menuClass)).remove()}}let C=null;function x(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return C&&!t||(C=d.initEmojiMap().then((function(){const t=new k(d);return t.bindEvents(),t}))),C}},"1OWu":function(t,e,n){"use strict";n.d(e,"d",(function(){return s})),n.d(e,"a",(function(){return o})),n.d(e,"f",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return l})),n.d(e,"g",(function(){return c})),n.d(e,"e",(function(){return d}));n("orcL"),n("7jeQ");var i=n("NmEs");const s=function(t){return Boolean(t&&t.scrollWidth>t.offsetWidth)},o=function(t,e){t&&t.classList.add(e)},r=function(){return Object(i.B)()||Object(i.y)()||Object(i.C)()},a=function(t){let{scrollTop:e}=t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e>n},l=function(t){let{scrollTop:e,offsetHeight:n,scrollHeight:i}=t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e+n<i-s},c=function(t,e){t&&Object.entries(e).map((function(e){let[n,i]=e;i?t.classList.add(n):t.classList.remove(n)}))},d=function(t){return Boolean(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}},"53m/":function(t,e,n){(function(e){window,t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,n){var i,s,o,r,a=[].indexOf;i=function(t){return Array.prototype.slice.apply(t)},o=function(t,e){for(;t&&!t.classList.contains(e);)t=t.parentNode;return t},r=function(t,e){var n;return"function"==typeof Event?(n=new Event(t,{bubbles:!0,cancelable:!0})).detail=e:(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,e),n},s=function(){class t{constructor(t){this.el=t,this.container=o(this.el,"js-task-list-container"),this.field=this.container.querySelector(".js-task-list-field"),this.container.addEventListener("change",t=>{if(t.target.classList.contains("task-list-item-checkbox"))return this.updateTaskList(t.target)}),this.enable()}enable(){var t;if(this.container.querySelectorAll(".js-task-list-field").length>0)return i(this.container.querySelectorAll(".task-list-item")).forEach((function(t){return t.classList.add("enabled")})),i(this.container.querySelectorAll(".task-list-item-checkbox")).forEach((function(t){return t.disabled=!1})),this.container.classList.add("is-task-list-enabled"),t=r("tasklist:enabled"),this.container.dispatchEvent(t)}disable(){var t;return i(this.container.querySelectorAll(".task-list-item")).forEach((function(t){return t.classList.remove("enabled")})),i(this.container.querySelectorAll(".task-list-item-checkbox")).forEach((function(t){return t.disabled=!0})),this.container.classList.remove("is-task-list-enabled"),t=r("tasklist:disabled"),this.container.dispatchEvent(t)}updateTaskList(e){var n,s,o,a,l,c,d;if(o=this.container.querySelectorAll(".task-list-item-checkbox"),a=1+i(o).indexOf(e),n=r("tasklist:change",{index:a,checked:e.checked}),this.field.dispatchEvent(n),!n.defaultPrevented)return({result:d,lineNumber:l,lineSource:c}=t.updateSource(this.field.value,a,e.checked,e)),this.field.value=d,n=r("change"),this.field.dispatchEvent(n),s=r("tasklist:changed",{index:a,checked:e.checked,lineNumber:l,lineSource:c}),this.field.dispatchEvent(s)}static escapePattern(t){return t.replace(/([\[\]])/g,"\\$1").replace(/\s/,"\\s").replace("x","[xX]")}static updateSource(t,e,n,i){return i.parentElement.hasAttribute("data-sourcepos")?this._updateSourcePosition(t,i,n):this._updateSourceRegex(t,e,n)}static _updateSourcePosition(t,e,n){var i,s,o,r,a;return r=t.split("\n"),a=e.parentElement.getAttribute("data-sourcepos"),o=r[(s=parseInt(a.split(":")[0]))-1],i=n?o.replace(this.incompletePattern,this.complete):o.replace(this.completePattern,this.incomplete),r[s-1]=i,{result:r.join("\n"),lineNumber:s,lineSource:o}}static _updateSourceRegex(t,e,n){var i,s,o,r,l,c,d,u;return u=t.split("\n"),i=t.replace(/\r/g,"").replace(this.itemsInParasPattern,"").split("\n"),r=0,o=!1,{result:function(){var t,h,m;for(m=[],s=t=0,h=u.length;t<h;s=++t)l=u[s],o?l.match(this.endFencesPattern)&&(o=!1):l.match(this.startFencesPattern)?o=!0:a.call(i,l)>=0&&l.trim().match(this.itemPattern)&&(r+=1)===e&&(c=s+1,d=l,l=n?l.replace(this.incompletePattern,this.complete):l.replace(this.completePattern,this.incomplete)),m.push(l);return m}.call(this).join("\n"),lineNumber:c,lineSource:d}}}return t.incomplete="[ ]",t.complete="[x]",t.incompletePattern=RegExp(`${t.escapePattern(t.incomplete)}`),t.completePattern=RegExp(`${t.escapePattern(t.complete)}`),t.itemPattern=RegExp(`^(?:\\s*(?:>\\s*)*(?:[-+*]|(?:\\d+\\.)))\\s*(${t.escapePattern(t.complete)}|${t.escapePattern(t.incomplete)})\\s`),t.startFencesPattern=/^`{3}.*$/,t.endFencesPattern=/^`{3}$/,t.itemsInParasPattern=RegExp(`^(${t.escapePattern(t.complete)}|${t.escapePattern(t.incomplete)}).+$`,"g"),t}.call(this),void 0!==e&&(e.fn.taskList=function(t){return this.each((function(n,i){var o;if((o=e(i).data("task-list"))||(o=new s(i),e(i).data("task-list",o),t&&"enable"!==t))return o[t||"enable"]()}))}),t.exports=s}])}).call(this,n("EmJ/"))},"9RX+":function(t,e){t.exports=function(t){return t!=t}},GY8p:function(t,e){t.exports=function(t,e,n){for(var i=-1,s=null==t?0:t.length;++i<s;)if(n(e,t[i]))return!0;return!1}},"Ge+5":function(t,e,n){"use strict";var i=n("4lAS"),s=n("Pyw5"),o=n.n(s);const r={name:"CloseButton",components:{GlButton:i.a},props:{label:{type:String,required:!1,default:"Close"}}};const a=o()({render:function(){var t=this.$createElement;return(this._self._c||t)("gl-button",this._g(this._b({attrs:{category:"tertiary",size:"small",icon:"close","aria-label":this.label}},"gl-button",this.$attrs,!1),this.$listeners))},staticRenderFns:[]},void 0,r,void 0,!1,void 0,!1,void 0,void 0,void 0);e.a=a},KZGt:function(t,e){t.exports=function(){}},LkaW:function(t,e,n){"use strict";var i=n("0zRR"),s=n("/Szx"),o=n("lgrP");var r=s.a.extend({name:i.v,functional:!0,props:{tag:{type:String,default:"p"},textClass:{type:[String,Array,Object]},variant:{type:String}},render:function(t,e){var n,i,s,r=e.props,a=e.data,l=e.children,c=r.tag,d=r.textClass,u=r.variant,h=a.attrs||{};return a.attrs={},t("li",Object(o.a)(a,{attrs:{role:"presentation"}}),[t(c,{staticClass:"b-dropdown-text",class:[d,(n={},i="text-".concat(u),s=u,i in n?Object.defineProperty(n,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[i]=s,n)],props:r,attrs:h,ref:"text"},l)])}}),a=n("Pyw5");const l={components:{BDropdownText:r},inheritAttrs:!1};const c=n.n(a)()({render:function(){var t=this.$createElement;return(this._self._c||t)("b-dropdown-text",this._g(this._b({staticClass:"gl-new-dropdown-text"},"b-dropdown-text",this.$attrs,!1),this.$listeners),[this._t("default")],2)},staticRenderFns:[]},void 0,l,void 0,!1,void 0,!1,void 0,void 0,void 0);e.a=c},Naob:function(t,e,n){"use strict";n("orcL");const i="data-dropdown-trigger",s="droplab-item-selected",o="droplab-item-ignore",r=/\{\{(.+?)\}\}/g;n("S26F"),n("pBsb");var a=n("05sH"),l=n.n(a);var c={toCamelCase(t){return this.camelize(t.split("-").slice(1).join(" "))},template:(t,e)=>l()(t,{escape:r})(e),camelize:t=>t.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(t,e){return 0===e?t.toLowerCase():t.toUpperCase()})).replace(/\s+/g,""),closest(t,e){for(;t&&t.tagName!==e&&"HTML"!==t.tagName;)t=t.parentNode;return t},isDropDownParts:t=>!(!t||!t.hasAttribute||"HTML"===t.tagName)&&(t.hasAttribute(i)||t.hasAttribute("data-dropdown"))};class d{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.currentIndex=0,this.hidden=!0,this.list="string"==typeof t?document.querySelector(t):t,this.items=[],this.eventWrapper={},this.hideOnClick=!1!==e.hideOnClick,e.addActiveClassToDropdownButton&&(this.dropdownToggle=this.list.parentNode.querySelector(".js-dropdown-toggle")),this.getItems(),this.initTemplateString(),this.addEvents(),this.initialState=t.innerHTML}getItems(){return this.items=[].slice.call(this.list.querySelectorAll("li")),this.items}initTemplateString(){const t=this.items||this.getItems();let e="";return t.length>0&&(e=t[t.length-1].outerHTML),this.templateString=e,this.templateString}clickEvent(t){if("UL"===t.target.tagName)return;if(t.target.closest(".".concat(o)))return;const e=t.target.closest("li");if(!e)return;this.addSelectedClass(e),t.preventDefault(),this.hideOnClick&&this.hide();const n=new CustomEvent("click.dl",{detail:{list:this,selected:e,data:t.target.dataset}});this.list.dispatchEvent(n)}addSelectedClass(t){this.removeSelectedClasses(),t.classList.add(s)}removeSelectedClasses(){(this.items||this.getItems()).forEach((function(t){return t.classList.remove(s)}))}addEvents(){this.eventWrapper.clickEvent=this.clickEvent.bind(this),this.eventWrapper.closeDropdown=this.closeDropdown.bind(this),this.list.addEventListener("click",this.eventWrapper.clickEvent),this.list.addEventListener("keyup",this.eventWrapper.closeDropdown)}closeDropdown(t){return 27!==t.keyCode||(t.preventDefault(),this.toggle())}setData(t){this.data=t,this.render(t)}addData(t){this.data=(this.data||[]).concat(t),this.render(this.data)}render(t){const e=t?t.map(this.renderChildren.bind(this)):[];if(this.list.querySelector(".filter-dropdown-loading"))return;(this.list.querySelector("ul[data-dynamic]")||this.list).innerHTML=e.join("");const n=new CustomEvent("render.dl",{detail:{list:this}});this.list.dispatchEvent(n)}renderChildren(t){const e=c.template(this.templateString,t),n=document.createElement("div");return n.innerHTML=e,d.setImagesSrc(n),n.firstChild.style.display=t.droplab_hidden?"none":"block",n.firstChild.outerHTML}show(){this.hidden&&(this.list.style.display="block",this.currentIndex=0,this.hidden=!1,this.dropdownToggle&&this.dropdownToggle.classList.add("active"))}hide(){this.hidden||(this.list.style.display="none",this.currentIndex=0,this.hidden=!0,this.dropdownToggle&&this.dropdownToggle.classList.remove("active"))}toggle(){return this.hidden?this.show():this.hide()}destroy(){this.hide(),this.list.removeEventListener("click",this.eventWrapper.clickEvent),this.list.removeEventListener("keyup",this.eventWrapper.closeDropdown)}static setImagesSrc(t){[...t.querySelectorAll("img[data-src]")].forEach((function(t){const e=t;e.src=e.getAttribute("data-src"),e.removeAttribute("data-src")}))}}var u=d;var h=class{constructor(t,e,n,i){this.trigger=t,this.list=new u(e,i),this.type="Hook",this.event="click",this.plugins=n||[],this.config=i||{},this.id=t.id}};var m=class extends h{constructor(t,e,n,i){super(t,e,n,i),this.type="button",this.event="click",this.eventWrapper={},this.addEvents(),this.addPlugins()}addPlugins(){var t=this;this.plugins.forEach((function(e){return e.init(t)}))}clicked(t){t.preventDefault();const e=new CustomEvent("click.dl",{detail:{hook:this},bubbles:!0,cancelable:!0});t.target.dispatchEvent(e),this.list.toggle()}addEvents(){this.eventWrapper.clicked=this.clicked.bind(this),this.trigger.addEventListener("click",this.eventWrapper.clicked)}removeEvents(){this.trigger.removeEventListener("click",this.eventWrapper.clicked)}restoreInitialState(){this.list.list.innerHTML=this.list.initialState}removePlugins(){this.plugins.forEach((function(t){return t.destroy()}))}destroy(){this.restoreInitialState(),this.removeEvents(),this.removePlugins()}};var f=class extends h{constructor(t,e,n,i){super(t,e,n,i),this.type="input",this.event="input",this.eventWrapper={},this.addEvents(),this.addPlugins()}addPlugins(){var t=this;this.plugins.forEach((function(e){return e.init(t)}))}addEvents(){this.eventWrapper.mousedown=this.mousedown.bind(this),this.eventWrapper.input=this.input.bind(this),this.eventWrapper.keyup=this.keyup.bind(this),this.eventWrapper.keydown=this.keydown.bind(this),this.trigger.addEventListener("mousedown",this.eventWrapper.mousedown),this.trigger.addEventListener("input",this.eventWrapper.input),this.trigger.addEventListener("keyup",this.eventWrapper.keyup),this.trigger.addEventListener("keydown",this.eventWrapper.keydown)}removeEvents(){this.hasRemovedEvents=!0,this.trigger.removeEventListener("mousedown",this.eventWrapper.mousedown),this.trigger.removeEventListener("input",this.eventWrapper.input),this.trigger.removeEventListener("keyup",this.eventWrapper.keyup),this.trigger.removeEventListener("keydown",this.eventWrapper.keydown)}input(t){if(this.hasRemovedEvents)return;this.list.show();const e=new CustomEvent("input.dl",{detail:{hook:this,text:t.target.value},bubbles:!0,cancelable:!0});t.target.dispatchEvent(e)}mousedown(t){if(this.hasRemovedEvents)return;const e=new CustomEvent("mousedown.dl",{detail:{hook:this,text:t.target.value},bubbles:!0,cancelable:!0});t.target.dispatchEvent(e)}keyup(t){this.hasRemovedEvents||this.keyEvent(t,"keyup.dl")}keydown(t){this.hasRemovedEvents||this.keyEvent(t,"keydown.dl")}keyEvent(t,e){this.list.show();const n=new CustomEvent(e,{detail:{hook:this,text:t.target.value,which:t.which,key:t.key},bubbles:!0,cancelable:!0});t.target.dispatchEvent(n)}restoreInitialState(){this.list.list.innerHTML=this.list.initialState}removePlugins(){this.plugins.forEach((function(t){return t.destroy()}))}destroy(){this.restoreInitialState(),this.removeEvents(),this.removePlugins(),this.list.destroy()}};var p=function(){var t,e=!1,n=!1,i=function(t){for(var e=Array.prototype.slice.call(t.list.querySelectorAll("li:not(.divider):not(.hidden)"),0),n=[],i=0;i<e.length;i++){var s=e[i];s.classList.remove("droplab-item-active"),"none"!==s.style.display&&n.push(s)}return n},s=function(t){var e=i(t)[t.currentIndex-1],n=new CustomEvent("click.dl",{detail:{list:t,selected:e,data:e.dataset}});t.list.dispatchEvent(n),t.hide()};document.addEventListener("mousedown.dl",(function(t){var s=t.detail.hook.list;i(s),s.show(),s.currentIndex=0,e=!1,n=!1})),document.addEventListener("keydown.dl",(function(o){o.target;var r=o.detail.hook.list,a=r.currentIndex;if(e=!1,n=!1,o.detail.which){if(13===(t=o.detail.which))return void s(o.detail.hook.list);38===t&&(e=!0),40===t&&(n=!0)}else if(o.detail.key){if("Enter"===(t=o.detail.key))return void s(o.detail.hook.list);"ArrowUp"===t&&(e=!0),"ArrowDown"===t&&(n=!0)}e&&a--,n&&a++,a<0&&(a=0),r.currentIndex=a,function(t){var e=i(t);if(t.currentIndex>0&&(e[t.currentIndex-1]||(t.currentIndex=t.currentIndex-1),e[t.currentIndex-1])){var n=e[t.currentIndex-1],s=n.closest(".filter-dropdown");if(n.classList.add("droplab-item-active"),s){var o=s.offsetHeight,r=n.offsetTop-30;r>o&&(s.scrollTop=r-o)}}}(o.detail.hook.list)}))};e.a=class{constructor(){this.ready=!1,this.hooks=[],this.queuedData=[],this.config={},this.eventWrapper={}}loadStatic(){const t=[].slice.apply(document.querySelectorAll("[".concat(i,"]")));this.addHooks(t)}addData(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.applyArgs(e,"processAddData")}setData(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.applyArgs(e,"processSetData")}destroy(){this.hooks.forEach((function(t){return t.destroy()})),this.hooks=[],this.removeEvents()}applyArgs(t,e){return this.ready?this[e](...t):(this.queuedData=this.queuedData||[],this.queuedData.push(t),this.ready)}processAddData(t,e){this.processData(t,e,"addData")}processSetData(t,e){this.processData(t,e,"setData")}processData(t,e,n){this.hooks.forEach((function(i){Array.isArray(t)&&i.list[n](t),i.trigger.id===t&&i.list[n](e)}))}addEvents(){this.eventWrapper.documentClicked=this.documentClicked.bind(this),document.addEventListener("click",this.eventWrapper.documentClicked)}documentClicked(t){if(!t.defaultPrevented&&!c.isDropDownParts(t.target)){if("UL"!==t.target.tagName){const e=c.closest(t.target,"UL");if(c.isDropDownParts(e))return}this.hooks.forEach((function(t){return t.list.hide()}))}}removeEvents(){document.removeEventListener("click",this.eventWrapper.documentClicked)}changeHookList(t,e,n,i){var s=this;const o="string"==typeof t?document.getElementById(t):t;this.hooks.forEach((function(t,r){const a=t;a.list.list.dataset.dropdownActive=!1,a.trigger===o&&(a.destroy(),s.hooks.splice(r,1),s.addHook(o,e,n,i))}))}addHook(t,e,n,s){const o="string"==typeof t?document.querySelector(t):t;let r;(r="string"==typeof e?document.querySelector(e):e instanceof Element?e:document.querySelector(t.dataset[c.toCamelCase(i)])).dataset.dropdownActive=!0;const a="INPUT"===o.tagName?f:m;return this.hooks.push(new a(o,r,n,s)),this}addHooks(t,e,n){var i=this;return t.forEach((function(t){return i.addHook(t,null,e,n)})),this}setConfig(t){this.config=t}fireReady(){const t=new CustomEvent("ready.dl",{detail:{dropdown:this}});document.dispatchEvent(t),this.ready=!0}init(t,e,n,i){var s=this;return t?this.addHook(t,e,n,i):this.loadStatic(),this.addEvents(),p(),this.fireReady(),this.queuedData.forEach((function(t){return s.addData(t)})),this.queuedData=[],this}}},P9pc:function(t,e){t.exports=function(t,e,n){for(var i=n-1,s=t.length;++i<s;)if(t[i]===e)return i;return-1}},QBXl:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("EmJ/"),s=n.n(i),o=(n("53m/"),n("/lV4")),r=n("XRO8"),a=n("2ibD");class l{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selector=t.selector,this.dataType=t.dataType,this.fieldName=t.fieldName,this.lockVersion=t.lockVersion,this.taskListContainerSelector="".concat(this.selector," .js-task-list-container"),this.updateHandler=this.update.bind(this),this.onSuccess=t.onSuccess||function(){},this.onError=t.onError||function(t){let e="";return t.response.data&&"object"==typeof t.response.data&&(e=t.response.data.errors.join(" ")),new r.c(e||Object(o.a)("Update failed"),"alert")},this.init()}init(){this.disable(),document.querySelectorAll("".concat(this.taskListContainerSelector," .js-task-list-field[data-value]")).forEach((function(t){t.value=t.dataset.value})),this.enable()}getTaskListTarget(t){return t&&t.currentTarget?s()(t.currentTarget):s()(this.taskListContainerSelector)}disableNonMarkdownTaskListItems(t){this.getTaskListTarget(t).find(".task-list-item").not("[data-sourcepos]").find(".task-list-item-checkbox").prop("disabled",!0)}disableTaskListItems(t){this.getTaskListTarget(t).taskList("disable")}enableTaskListItems(t){this.getTaskListTarget(t).taskList("enable"),this.disableNonMarkdownTaskListItems(t)}enable(){this.enableTaskListItems(),s()(document).on("tasklist:changed",this.taskListContainerSelector,this.updateHandler)}disable(){this.disableTaskListItems(),s()(document).off("tasklist:changed",this.taskListContainerSelector)}update(t){var e=this;const n=s()(t.target),{index:i,checked:o,lineNumber:r,lineSource:l}=t.detail,c={};return c[this.dataType]={[this.fieldName]:n.val(),lock_version:this.lockVersion,update_task:{index:i,checked:o,line_number:r,line_source:l}},this.disableTaskListItems(t),a.a.patch(n.data("updateUrl")||s()("form.js-issuable-update").attr("action"),c).then((function(n){let{data:i}=n;return e.lockVersion=i.lock_version,e.enableTaskListItems(t),e.onSuccess(i)})).catch((function(n){let{response:i}=n;return e.enableTaskListItems(t),e.onError(i.data)}))}}},QPL1:function(t,e,n){var i=n("pFYY"),s=n("KZGt"),o=n("1XSk"),r=i&&1/o(new i([,-0]))[1]==1/0?function(t){return new i(t)}:s;t.exports=r},QPeP:function(t,e,n){var i=n("q+Dt");t.exports=function(t,e){return!!(null==t?0:t.length)&&i(t,e,0)>-1}},QlUp:function(t,e,n){"use strict";var i=n("BrvI");e.a={props:{state:{type:Boolean,default:null}},computed:{computedState:function(){return Object(i.b)(this.state)?this.state:null},stateClass:function(){var t=this.computedState;return!0===t?"is-valid":!1===t?"is-invalid":null}}}},Qo4I:function(t,e,n){"use strict";var i=n("o/E4"),s=n("QXXq"),o=n("BrvI"),r=n("9aS3"),a=n("Ddgg"),l=n("bvam");e.a={model:{prop:"value",event:"update"},props:{value:{type:[String,Number],default:""},ariaInvalid:{type:[Boolean,String],default:!1},readonly:{type:Boolean,default:!1},plaintext:{type:Boolean,default:!1},autocomplete:{type:String},placeholder:{type:String},formatter:{type:Function},lazyFormatter:{type:Boolean,default:!1},trim:{type:Boolean,default:!1},number:{type:Boolean,default:!1},lazy:{type:Boolean,default:!1},debounce:{type:[Number,String],default:0}},data:function(){return{localValue:Object(l.e)(this.value),vModelValue:this.value}},computed:{computedClass:function(){return[{"custom-range":"range"===this.type,"form-control-plaintext":this.plaintext&&"range"!==this.type&&"color"!==this.type,"form-control":!this.plaintext&&"range"!==this.type||"color"===this.type},this.sizeFormClass,this.stateClass]},computedAriaInvalid:function(){return this.ariaInvalid&&"false"!==this.ariaInvalid?!0===this.ariaInvalid?"true":this.ariaInvalid:!1===this.computedState?"true":null},computedDebounce:function(){return Object(r.b)(Object(a.c)(this.debounce,0),0)},hasFormatter:function(){return Object(o.e)(this.formatter)}},watch:{value:function(t){var e=Object(l.e)(t);e!==this.localValue&&t!==this.vModelValue&&(this.clearDebounce(),this.localValue=e,this.vModelValue=t)}},created:function(){this.$_inputDebounceTimer=null},mounted:function(){this.$on("hook:beforeDestroy",this.clearDebounce);var t=this.value,e=Object(l.e)(t);e!==this.localValue&&t!==this.vModelValue&&(this.localValue=e,this.vModelValue=t)},methods:{clearDebounce:function(){clearTimeout(this.$_inputDebounceTimer),this.$_inputDebounceTimer=null},formatValue:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t=Object(l.e)(t),!this.hasFormatter||this.lazyFormatter&&!n||(t=this.formatter(t,e)),t},modifyValue:function(t){return this.trim&&(t=t.trim()),this.number&&(t=Object(a.b)(t,t)),t},updateValue:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.lazy;if(!i||n){this.clearDebounce();var s=function(){if((t=e.modifyValue(t))!==e.vModelValue)e.vModelValue=t,e.$emit("update",t);else if(e.hasFormatter){var n=e.$refs.input;n&&t!==n.value&&(n.value=t)}},o=this.computedDebounce;o>0&&!i&&!n?this.$_inputDebounceTimer=setTimeout(s,o):s()}},onInput:function(t){if(!t.target.composing){var e=t.target.value,n=this.formatValue(e,t);!1===n||t.defaultPrevented?Object(s.d)(t,{propagation:!1}):(this.localValue=n,this.updateValue(n),this.$emit("input",n))}},onChange:function(t){var e=t.target.value,n=this.formatValue(e,t);!1===n||t.defaultPrevented?Object(s.d)(t,{propagation:!1}):(this.localValue=n,this.updateValue(n,!0),this.$emit("change",n))},onBlur:function(t){var e=t.target.value,n=this.formatValue(e,t,!0);!1!==n&&(this.localValue=Object(l.e)(this.modifyValue(n)),this.updateValue(n,!0)),this.$emit("blur",t)},focus:function(){this.disabled||Object(i.d)(this.$el)},blur:function(){this.disabled||Object(i.c)(this.$el)}}}},TBBL:function(t,e,n){"use strict";var i=n("Pyw5");const s={props:{lines:{type:Number,required:!1,default:3,validator:function(t){return t>0&&t<4}}},computed:{lineClasses:function(){return new Array(this.lines).fill().map((function(t,e){return"skeleton-line-".concat(e+1)}))}}};const o=n.n(i)()({render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"animation-container"},this._l(this.lineClasses,(function(t,n){return e("div",{key:n,class:t})})),0)},staticRenderFns:[]},void 0,s,void 0,!1,void 0,!1,void 0,void 0,void 0);e.a=o},Tu1i:function(t,e,n){"use strict";var i=n("t8l0");e.a={props:{size:{type:String,default:function(){return Object(i.b)("formControls","size")}}},computed:{sizeFormClass:function(){return[this.size?"form-control-".concat(this.size):null]},sizeBtnClass:function(){return[this.size?"btn-".concat(this.size):null]}}}},Vxxt:function(t,e,n){"use strict";var i=n("o/E4");e.a={props:{name:{type:String},id:{type:String},disabled:{type:Boolean},required:{type:Boolean,default:!1},form:{type:String},autofocus:{type:Boolean,default:!1}},mounted:function(){this.handleAutofocus()},activated:function(){this.handleAutofocus()},methods:{handleAutofocus:function(){var t=this;this.$nextTick((function(){Object(i.B)((function(){var e=t.$el;t.autofocus&&Object(i.u)(e)&&(Object(i.v)(e,"input, textarea, select")||(e=Object(i.C)("input, textarea, select",e)),Object(i.d)(e))}))}))}}}},W0S0:function(t,e,n){"use strict";var i=n("uqFy");e.a=function(){const t=document.querySelector(".js-notes-data"),{notesUrl:e,notesIds:n,now:s,diffView:o,enableGFM:r}=JSON.parse(t.innerHTML);i.a.initialize(e,n,s,o,r)}},ZKBa:function(t,e,n){"use strict";e.a={computed:{selectionStart:{cache:!1,get:function(){return this.$refs.input.selectionStart},set:function(t){this.$refs.input.selectionStart=t}},selectionEnd:{cache:!1,get:function(){return this.$refs.input.selectionEnd},set:function(t){this.$refs.input.selectionEnd=t}},selectionDirection:{cache:!1,get:function(){return this.$refs.input.selectionDirection},set:function(t){this.$refs.input.selectionDirection=t}}},methods:{select:function(){var t;(t=this.$refs.input).select.apply(t,arguments)},setSelectionRange:function(){var t;(t=this.$refs.input).setSelectionRange.apply(t,arguments)},setRangeText:function(){var t;(t=this.$refs.input).setRangeText.apply(t,arguments)}}}},"d+lS":function(t,e,n){var i=n("dA+0");t.exports=function(t){return t&&t.length?i(t):[]}},d5X7:function(t,e,n){"use strict";const i={init(t){this.hook=t,this.destroyed=!1,this.config=t.config.InputSetter||(this.hook.config.InputSetter={}),this.eventWrapper={},this.addEvents()},addEvents(){this.eventWrapper.setInputs=this.setInputs.bind(this),this.hook.list.list.addEventListener("click.dl",this.eventWrapper.setInputs)},removeEvents(){this.hook.list.list.removeEventListener("click.dl",this.eventWrapper.setInputs)},setInputs(t){var e=this;if(this.destroyed)return;const n=t.detail.selected;Array.isArray(this.config)||(this.config=[this.config]),this.config.forEach((function(t){return e.setInput(t,n)}))},setInput(t,e){const n=t.input||this.hook.trigger,i=e.getAttribute(t.valueAttribute),s=t.inputAttribute;return n.hasAttribute(s)?n.setAttribute(s,i):"INPUT"===n.tagName?n.value=i:n.textContent=i},destroy(){this.destroyed=!0,this.removeEvents()}};e.a=i},"dA+0":function(t,e,n){var i=n("4O6w"),s=n("QPeP"),o=n("GY8p"),r=n("5PFN"),a=n("QPL1"),l=n("1XSk"),c=200;t.exports=function(t,e,n){var d=-1,u=s,h=t.length,m=!0,f=[],p=f;if(n)m=!1,u=o;else if(h>=c){var g=e?null:a(t);if(g)return l(g);m=!1,u=r,p=new i}else p=e?[]:f;t:for(;++d<h;){var v=t[d],b=e?e(v):v;if(v=n||0!==v?v:0,m&&b==b){for(var j=p.length;j--;)if(p[j]===b)continue t;e&&p.push(b),f.push(v)}else u(p,b,n)||(p!==f&&p.push(b),f.push(v))}return f}},"q+Dt":function(t,e,n){var i=n("sjqF"),s=n("9RX+"),o=n("P9pc");t.exports=function(t,e,n){return e==e?o(t,e,n):i(t,s,n)}},sjqF:function(t,e){t.exports=function(t,e,n,i){for(var s=t.length,o=n+(i?1:-1);i?o--:++o<s;)if(e(t[o],o,t))return o;return-1}},tRCE:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("n7CP");class s{constructor(t,e,n,s){var o=this;this.field=t,this.isLocalStorageAvailable=i.a.isLocalStorageAccessSafe(),null!=e.join&&(e=e.join("/")),this.key="autosave/".concat(e),this.fallbackKey=n,this.lockVersionKey="".concat(this.key,"/lockVersion"),this.lockVersion=s,this.field.data("autosave",this),this.restore(),this.field.on("input",(function(){return o.save()}))}restore(){if(!this.isLocalStorageAvailable)return;if(!this.field.length)return;const t=window.localStorage.getItem(this.key),e=window.localStorage.getItem(this.fallbackKey);t?this.field.val(t):e&&this.field.val(e),this.field.trigger("input");const n=new Event("change",{bubbles:!0,cancelable:!1}),i=this.field.get(0);i&&i.dispatchEvent(n)}getSavedLockVersion(){if(this.isLocalStorageAvailable)return window.localStorage.getItem(this.lockVersionKey)}save(){if(!this.field.length)return;const t=this.field.val();return this.isLocalStorageAvailable&&t?(this.fallbackKey&&window.localStorage.setItem(this.fallbackKey,t),void 0!==this.lockVersion&&window.localStorage.setItem(this.lockVersionKey,this.lockVersion),window.localStorage.setItem(this.key,t)):this.reset()}reset(){if(this.isLocalStorageAvailable)return window.localStorage.removeItem(this.lockVersionKey),window.localStorage.removeItem(this.fallbackKey),window.localStorage.removeItem(this.key)}dispose(){this.field.off("input")}}},uqFy:function(t,e,n){"use strict";n.d(e,"a",(function(){return P}));n("z4I3"),n("jaBk"),n("Ag57"),n("GzNv"),n("S26F"),n("pBsb"),n("+xeR"),n("orcL");var i=n("o4PY"),s=n.n(i),o=n("G3fq"),r=n.n(o),a=n("TBBL"),l=n("k5du"),c=n.n(l),d=n("EmJ/"),u=n.n(d),h=n("06tH"),m=n.n(h),f=n("jB52"),p=(n("uK44"),n("Gs6c")),g=n("FYnm"),v=n("tRCE"),b=n("/ode"),j=n("Naob");function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function w(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const E=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){w(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},n("d5X7").a);var k=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.dropdownTrigger=t.dropdownTrigger,this.dropdownList=t.dropdownList,this.noteTypeInput=t.noteTypeInput,this.submitButton=t.submitButton,this.closeButton=t.closeButton,this.reopenButton=t.reopenButton}initDroplab(){this.droplab=new j.a;const t=this.setConfig();this.droplab.init(this.dropdownTrigger,this.dropdownList,[E],t)}setConfig(){const t={InputSetter:[{input:this.noteTypeInput,valueAttribute:"data-value"},{input:this.submitButton,valueAttribute:"data-submit-text"}]};return this.closeButton&&t.InputSetter.push({input:this.closeButton,valueAttribute:"data-close-text"},{input:this.closeButton,valueAttribute:"data-close-text",inputAttribute:"data-alternative-text"}),this.reopenButton&&t.InputSetter.push({input:this.reopenButton,valueAttribute:"data-reopen-text"},{input:this.reopenButton,valueAttribute:"data-reopen-text",inputAttribute:"data-alternative-text"}),t}},C=n("XRO8"),x=n("Jn9D"),S=n("FVJN"),T=n("2ibD"),N=n("NmEs"),_=n("bOix"),A=n("3twG"),L=n("/lV4"),D=n("QBXl");function I(t){return t.replace(/\r\n/g,"\n")}window.autosize=c.a;const F=3,O=/^\/\w+.*$/gm;class P{static initialize(t,e,n,i,s){this.instance||(this.instance=new P(t,e,n,i,s))}static getInstance(){return this.instance}constructor(t,e,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:x.b;this.updateTargetButtons=this.updateTargetButtons.bind(this),this.updateComment=this.updateComment.bind(this),this.visibilityChange=this.visibilityChange.bind(this),this.cancelDiscussionForm=this.cancelDiscussionForm.bind(this),this.onAddDiffNote=this.onAddDiffNote.bind(this),this.onAddImageDiffNote=this.onAddImageDiffNote.bind(this),this.setupDiscussionNoteForm=this.setupDiscussionNoteForm.bind(this),this.onReplyToDiscussionNote=this.onReplyToDiscussionNote.bind(this),this.removeNote=this.removeNote.bind(this),this.cancelEdit=this.cancelEdit.bind(this),this.updateNote=this.updateNote.bind(this),this.addDiscussionNote=this.addDiscussionNote.bind(this),this.addNoteError=this.addNoteError.bind(this),this.addNote=this.addNote.bind(this),this.resetMainTargetForm=this.resetMainTargetForm.bind(this),this.refresh=this.refresh.bind(this),this.keydownNoteText=this.keydownNoteText.bind(this),this.toggleCommitList=this.toggleCommitList.bind(this),this.postComment=this.postComment.bind(this),this.clearFlashWrapper=this.clearFlash.bind(this),this.onHashChange=this.onHashChange.bind(this),this.notes_url=t,this.note_ids=e,this.enableGFM=s,this.updatedNotesTrackingMap={},this.last_fetched_at=n,this.noteable_url=document.URL,this.notesCountBadge||(this.notesCountBadge=u()(".issuable-details").find(".notes-tab .badge")),this.basePollingInterval=15e3,this.maxPollingSteps=4,this.$wrapperEl=Object(N.C)()?u()(document).find(".diffs"):u()(document),this.cleanBinding(),this.addBinding(),this.setPollingInterval(),this.setupMainTargetNoteForm(s),this.taskList=new D.a({dataType:"note",fieldName:"note",selector:".notes"}),this.collapseLongCommitList(),this.setViewType(i),"merge_requests"===Object(N.o)(1)&&u()(".note-edit-form").clone().addClass("mr-note-edit-form").insertAfter(".note-edit-form");const o=Object(A.f)(),r=o&&document.getElementById(o);r&&this.loadLazyDiff({currentTarget:r})}setViewType(t){this.view=m.a.get("diff_view")||t}addBinding(){this.$wrapperEl.on("click",".js-note-edit",this.showEditForm.bind(this)),this.$wrapperEl.on("click",".note-edit-cancel",this.cancelEdit),this.$wrapperEl.on("click",".js-comment-submit-button",this.postComment),this.$wrapperEl.on("click",".js-comment-save-button",this.updateComment),this.$wrapperEl.on("keyup input",".js-note-text",this.updateTargetButtons),this.$wrapperEl.on("click",".js-comment-resolve-button",this.postComment),this.$wrapperEl.on("click",".js-note-delete",this.removeNote),this.$wrapperEl.on("click",".js-note-attachment-delete",this.removeAttachment),this.$wrapperEl.on("change",".js-note-attachment-input",this.updateFormAttachment),this.$wrapperEl.on("click",".js-discussion-reply-button",this.onReplyToDiscussionNote),this.$wrapperEl.on("click",".js-add-diff-note-button",this.onAddDiffNote),this.$wrapperEl.on("click",".js-add-image-diff-note-button",this.onAddImageDiffNote),this.$wrapperEl.on("click",".js-close-discussion-note-form",this.cancelDiscussionForm),this.$wrapperEl.on("click",".system-note-commit-list-toggler",this.toggleCommitList),this.$wrapperEl.on("click",".js-toggle-lazy-diff",this.loadLazyDiff),this.$wrapperEl.on("click",".js-toggle-lazy-diff-retry-button",this.onClickRetryLazyLoad.bind(this)),this.$wrapperEl.on("visibilitychange",this.visibilityChange),this.$wrapperEl.on("issuable:change",this.refresh),this.$wrapperEl.on("ajax:success",".js-main-target-form",this.addNote),this.$wrapperEl.on("ajax:success",".js-discussion-note-form",this.addDiscussionNote),this.$wrapperEl.on("ajax:success",".js-main-target-form",this.resetMainTargetForm),this.$wrapperEl.on("ajax:complete",".js-main-target-form",this.reenableTargetFormSubmitButton),this.$wrapperEl.on("keydown",".js-note-text",this.keydownNoteText),u()(window).on("hashchange",this.onHashChange)}cleanBinding(){this.$wrapperEl.off("click",".js-note-edit"),this.$wrapperEl.off("click",".note-edit-cancel"),this.$wrapperEl.off("click",".js-note-delete"),this.$wrapperEl.off("click",".js-note-attachment-delete"),this.$wrapperEl.off("click",".js-discussion-reply-button"),this.$wrapperEl.off("click",".js-add-diff-note-button"),this.$wrapperEl.off("click",".js-add-image-diff-note-button"),this.$wrapperEl.off("visibilitychange"),this.$wrapperEl.off("keyup input",".js-note-text"),this.$wrapperEl.off("click",".js-note-target-reopen"),this.$wrapperEl.off("click",".js-note-target-close"),this.$wrapperEl.off("keydown",".js-note-text"),this.$wrapperEl.off("click",".js-comment-resolve-button"),this.$wrapperEl.off("click",".system-note-commit-list-toggler"),this.$wrapperEl.off("click",".js-toggle-lazy-diff"),this.$wrapperEl.off("click",".js-toggle-lazy-diff-retry-button"),this.$wrapperEl.off("ajax:success",".js-main-target-form"),this.$wrapperEl.off("ajax:success",".js-discussion-note-form"),this.$wrapperEl.off("ajax:complete",".js-main-target-form"),u()(window).off("hashchange",this.onHashChange)}static initCommentTypeToggle(t){const e=t.querySelector(".js-comment-type-dropdown .dropdown-toggle"),n=t.querySelector(".js-comment-type-dropdown .dropdown-menu"),i=t.querySelector("#note_type"),s=t.querySelector(".js-comment-type-dropdown .js-comment-submit-button"),o=t.querySelector(".js-note-target-close"),r=t.querySelector(".js-note-target-reopen");new k({dropdownTrigger:e,dropdownList:n,noteTypeInput:i,submitButton:s,closeButton:o,reopenButton:r}).initDroplab()}keydownNoteText(t){let e,n,i,s,o,r;if(Object(N.G)(t))return;const a=u()(t.target);switch(t.which){case 38:if(""!==a.val())return;if((i=u()("li.note[data-author-id='".concat(gon.current_user_id,"'][data-editable]:last"),a.closest(".note, .notes_holder, #notes"))).length)return(s=i.find(".js-note-edit")).trigger("click",[!0,i]);break;case 27:if((e=a.closest(".js-discussion-note-form")).length){if(""!==a.val()&&!window.confirm(Object(L.a)("Your comment will be discarded.")))return;return void this.removeDiscussionNoteForm(e)}if((n=a.closest(".note")).length){if((r=a.closest("form").data("originalNote"))!==(o=a.val())&&!window.confirm(Object(L.a)("Are you sure you want to discard this comment?")))return;return this.removeNoteEditForm(n)}}}initRefresh(){var t=this;P.interval&&clearInterval(P.interval),P.interval=setInterval((function(){return t.refresh()}),this.pollingInterval)}refresh(){if(!document.hidden)return this.getContent()}getContent(){var t=this;this.refreshing||(this.refreshing=!0,T.a.get("".concat(this.notes_url,"?html=true"),{headers:{"X-Last-Fetched-At":this.last_fetched_at}}).then((function(e){let{data:n}=e;const{notes:i}=n;t.last_fetched_at=n.last_fetched_at,t.setPollingInterval(n.notes.length),u.a.each(i,(function(e,n){return t.renderNote(n)})),t.refreshing=!1})).catch((function(){t.refreshing=!1})))}setPollingInterval(t){null==t&&(t=!0);const e=this.basePollingInterval*Math.pow(2,this.maxPollingSteps-1);return t?this.pollingInterval=this.basePollingInterval:this.pollingInterval<e&&(this.pollingInterval*=2),this.initRefresh()}handleQuickActions(t){let e;t.commands_changes&&("merge"in t.commands_changes&&P.checkMergeRequestStatus(),"emoji_award"in t.commands_changes&&(e=u()(".js-awards-block").eq(0),Object(b.b)().then((function(n){n.addAwardToEmojiBar(e,t.commands_changes.emoji_award),n.scrollToAwards()})).catch((function(){}))))}setupNewNote(t){Object(_.x)(t.find(".js-timeago"),!1),this.collapseLongCommitList(),this.taskList.init(),P.updateNoteTargetSelector(t),this.$noteToCleanHighlight=t}onHashChange(){this.$noteToCleanHighlight&&P.updateNoteTargetSelector(this.$noteToCleanHighlight),this.$noteToCleanHighlight=null}static updateNoteTargetSelector(t){const e=Object(A.f)(),n=Boolean(e&&t.filter("#".concat(e)).length>0);t.toggleClass("target",n)}renderNote(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u()(".main-notes-list");if(t.discussion_html)return this.renderDiscussionNote(t,e);if(!t.valid)return void(t.errors&&t.errors.commands_only&&(t.commands_changes&&Object.keys(t.commands_changes).length>0&&n.find(".system-note.being-posted").remove(),this.addFlash({message:t.errors.commands_only,type:"notice",parent:this.parentTimeline.get(0)}),this.refresh()));const i=n.find("#note_".concat(t.id));if(P.isNewNote(t,this.note_ids)){if(Object(N.C)())return;this.note_ids.push(t.id),n.length&&n.find(".system-note.being-posted").remove();const e=P.animateAppendNote(t.html,n);return this.setupNewNote(e),this.refresh(),this.updateNotesCount(1)}if(P.isUpdatedNote(t,i)){const e=i.hasClass("is-editing"),n=I(i.find(".original-note-content").text().trim()),s=i.find(".js-note-text"),o=s.val(),r=I(t.note),a=o===n||o===r;if(e&&a)s.val(t.note),this.updatedNotesTrackingMap[t.id]=t;else if(e&&!a)this.putConflictEditWarningInPlace(t,i),this.updatedNotesTrackingMap[t.id]=t;else{const e=P.animateUpdateNote(t.html,i);this.setupNewNote(e)}}}isParallelView(){return"parallel"===m.a.get("diff_view")}renderDiscussionNote(t,e){let n,i;if(!P.isNewNote(t,this.note_ids))return;this.note_ids.push(t.id);const s=e||u()('.js-discussion-note-form[data-discussion-id="'.concat(t.discussion_id,'"]'));if(i=s.length||!t.discussion_line_code?s.closest("tr"):u()("#".concat(t.discussion_line_code)),t.on_image&&(i=s),(n=u()('.notes[data-discussion-id="'.concat(t.discussion_id,'"]'))).length||(n=s.closest(".discussion").find(".notes")),0===n.length)if(t.diff_discussion_html){const e=u()(t.diff_discussion_html).renderGFM();if(!this.isParallelView()||i.hasClass("js-temp-notes-holder")||t.on_image)i.after(e);else{const n=e.find('.notes[data-discussion-id="'.concat(t.discussion_id,'"]')),s=n.closest(".notes-content").attr("class").split(" ").join(".");i.find(".".concat(s," .content")).append(n.closest(".content").children())}}else P.animateAppendNote(t.discussion_html,u()(".main-notes-list"));else P.animateAppendNote(t.html,n);return Object(_.x)(u()(".js-timeago"),!1),P.checkMergeRequestStatus(),this.updateNotesCount(1)}getLineHolder(t){return u()(t).closest(".notes_holder").prevAll(".line_holder").first().get(0)}resetMainTargetForm(t){const e=u()(".js-main-target-form");e.find(".js-errors").remove(),e.find(".js-md-write-button").click(),e.find(".js-note-text").val("").trigger("input"),e.find(".js-note-text").data("autosave").reset();const n=document.createEvent("Event");n.initEvent("autosize:update",!0,!1),e.find(".js-autosize")[0].dispatchEvent(n),this.updateTargetButtons(t)}reenableTargetFormSubmitButton(){return u()(".js-main-target-form").find(".js-note-text").trigger("input")}setupMainTargetNoteForm(t){const e=u()(".js-new-note-form");this.formClone=e.clone(),this.setupNoteForm(e,t),e.removeClass("js-new-note-form"),e.addClass("js-main-target-form"),e.find("#note_line_code").remove(),e.find("#note_position").remove(),e.find("#note_type").val(""),e.find("#note_project_id").remove(),e.find("#in_reply_to_discussion_id").remove(),this.parentTimeline=e.parents(".timeline"),e.length&&P.initCommentTypeToggle(e.get(0))}setupNoteForm(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x.b;this.glForm=new S.a(t,e);const n=t.find(".js-note-text"),i=[Object(L.e)("NoteForm|Note"),t.find("#note_noteable_type").val(),t.find("#note_noteable_id").val(),t.find("#note_commit_id").val(),t.find("#note_type").val(),t.find("#note_project_id").val(),t.find("#in_reply_to_discussion_id").val(),t.find("#note_line_code").val(),t.find("#note_position").val()];return new v.a(n,i)}addNote(t,e){return this.renderNote(e)}addNoteError(t){let e;return t.hasClass("js-main-target-form")?e=t.parents(".timeline"):t.hasClass("js-discussion-note-form")&&(e=t.closest(".discussion-notes").find(".notes")),this.addFlash({message:Object(L.a)("Your comment could not be submitted! Please check your network connection and try again."),type:"alert",parent:e.get(0)})}updateNoteError(){Object(C.b)({message:Object(L.a)("Your comment could not be updated! Please check your network connection and try again.")})}addDiscussionNote(t,e,n){if(null!=t.attr("data-resolve-all")){const e=t.data("discussionId"),n=t.data("noteableIid");null!=ResolveService&&ResolveService.toggleResolveForDiscussion(n,e)}this.renderNote(e,t),n&&this.removeDiscussionNoteForm(t)}updateNote(t,e){const n=u()(t.html);this.revertNoteEditForm(e),n.renderGFM(),u()(".note-row-".concat(t.id)).replaceWith(n),this.setupNewNote(n)}checkContentToAllowEditing(t){const e=t.find(".original-note-content").text().trim();let n=!0;if(t.find(".js-note-text").val()===e)this.removeNoteEditForm(t);else{Object(N.E)(t.get(0))||Object(N.Q)(t),t.find(".js-finish-edit-warning").show(),n=!1}return n}showEditForm(t){t.preventDefault();const e=u()(t.target),n=u()(this.getEditFormSelector(e)),i=e.closest(".note"),s=u()(".note.is-editing:visible");if(s.length){if(!this.checkContentToAllowEditing(s))return}i.find(".js-note-attachment-delete").show(),n.addClass("current-note-edit-form"),i.addClass("is-editing"),this.putEditFormInPlace(e)}cancelEdit(t){t.preventDefault();const e=u()(t.target),n=e.closest(".note"),i=n.attr("data-note-id");if(this.revertNoteEditForm(e),this.updatedNotesTrackingMap[i]){const t=u()(this.updatedNotesTrackingMap[i].html);n.replaceWith(t),this.setupNewNote(t),delete this.updatedNotesTrackingMap[i]}else n.find(".js-finish-edit-warning").hide(),this.removeNoteEditForm(n)}revertNoteEditForm(t){t=t||u()(".note.is-editing:visible");const e=this.getEditFormSelector(t),n=u()(e);n.insertBefore(".diffs"),n.find(".js-comment-save-button").enable(),n.find(".js-finish-edit-warning").hide()}getEditFormSelector(t){let e=".note-edit-form:not(.mr-note-edit-form)";return t.parents("#diffs").length&&(e=".note-edit-form.mr-note-edit-form"),e}removeNoteEditForm(t){const e=t.find(".diffs .current-note-edit-form");return t.removeClass("is-editing"),e.removeClass("current-note-edit-form"),e.find(".js-finish-edit-warning").hide(),e.find(".js-note-text").val(e.find("form.edit-note").data("originalNote"))}removeNote(t){const e=u()(t.currentTarget).closest(".note").attr("id");return u()('.note[id="'.concat(e,'"]')).each((function(t,e){const n=u()(e),i=n.closest(".discussion-notes"),s=u()(".notes",i).data("discussionId");if(n.remove(),0===i.find(".note").length){const t=i.closest("tr");if(i.closest(".timeline-entry").remove(),u()(".js-diff-avatars-".concat(s)).trigger("remove.vue"),t.find(".discussion-notes").length>1||0===t.length){const t=i.closest(".diff-file");if(t.length>0){const e=new CustomEvent("removeBadge.imageDiff",{detail:{badgeNumber:i.index()+1}});t[0].dispatchEvent(e)}i.remove()}else t.length>0&&t.remove()}})),P.checkMergeRequestStatus(),this.updateNotesCount(-1)}removeAttachment(){const t=u()(this).closest(".note");return t.find(".note-attachment").remove(),t.find(".note-body > .note-text").show(),t.find(".note-header").show(),t.find(".diffs .current-note-edit-form").remove()}onReplyToDiscussionNote(t){this.replyToDiscussionNote(t.target)}replyToDiscussionNote(t){const e=this.cleanForm(this.formClone.clone()),n=u()(t).closest(".js-discussion-reply-button");return n.closest(".discussion-reply-holder").hide().after(e),this.setupDiscussionNoteForm(n,e)}setupDiscussionNoteForm(t,e){let n=t.closest(".text-file");0===n.length&&(n=t.closest(".image"));const i=t.data("discussionId");i&&(e.attr("data-discussion-id",i),e.find("#in_reply_to_discussion_id").val(i)),e.find("#note_project_id").val(t.data("discussionProjectId")),e.attr("data-line-code",t.data("lineCode")),e.find("#line_type").val(t.data("lineType")),e.find("#note_noteable_type").val(n.data("noteableType")),e.find("#note_noteable_id").val(n.data("noteableId")),e.find("#note_commit_id").val(n.data("commitId")),e.find("#note_type").val(t.data("noteType")),e.find("#note_line_code").val(t.data("lineCode")),e.find("#note_position").val(t.attr("data-position")),e.append("</div>").find(".js-close-discussion-note-form").show().removeClass("hide"),e.find(".js-note-target-close").remove(),e.find(".js-note-new-discussion").remove(),this.setupNoteForm(e),e.removeClass("js-main-target-form").addClass("discussion-form js-discussion-note-form"),e.find(".js-note-text").focus(),e.find(".js-comment-resolve-button").attr("data-discussion-id",i)}onAddDiffNote(t){t.preventDefault();const e=t.currentTarget||t.target,n=u()(e),i=!n.hasClass("js-diff-comment-avatar");this.toggleDiffNote({target:n,lineType:e.dataset.lineType,showReplyInput:i,currentUsername:gon.current_username,currentUserAvatar:gon.current_user_avatar_url,currentUserFullname:gon.current_user_fullname})}onAddImageDiffNote(t){const e=u()(t.currentTarget||t.target),n=e.closest(".diff-file"),i=new CustomEvent("click.imageDiff",{detail:t});let s;n[0].dispatchEvent(i);const o=e.closest(".diff-viewer").find(".note-container"),r=o.find("> .discussion-form");0===r.length?(s=this.cleanForm(this.formClone.clone())).appendTo(o):s=r,this.setupDiscussionNoteForm(e,s)}toggleDiffNote(t){let e,n,i,s,o,{target:r,lineType:a,forceShow:l,showReplyInput:c=!1}=t;const d=u()(r),h=d.closest("tr"),m=h.next();let f=h;m.is(".notes_holder")&&(f=m);const p=m.is(".notes_holder");e=!1;let g="";o='<tr class="notes_holder js-temp-notes-holder"><td class="notes-content" colspan="3"><div class="content"></div></td></tr>',this.isParallelView()&&(g=".".concat(a),o='<tr class="notes_holder js-temp-notes-holder"><td class="notes_line old"></td><td class="notes-content parallel old"><div class="content"></div></td><td class="notes_line new"></td><td class="notes-content parallel new"><div class="content"></div></td></tr>');const v=".notes-content".concat(g," .content");let b=f.find(v);if(p&&c)f.show(),(b=f.find(v)).length&&(b.show(),(s=b.find(".js-discussion-reply-button:visible")).length?this.replyToDiscussionNote(s[0]):0===(i=b.find(".js-discussion-note-form")).length&&(e=!0));else if(c)h.after(o),b=(f=h.next()).find(v),e=!0;else{const t=f.find(".content:not(:empty)").is(":visible"),e=!0===l||!1===l,n=!0===l||!t&&!e;f.toggleClass("hide",!n),b.toggleClass("hide",!n)}if(e)return(n=this.cleanForm(this.formClone.clone())).appendTo(b),this.setupDiscussionNoteForm(d,n)}removeDiscussionNoteForm(t){const e=t.closest("tr");return t.data("glForm").destroy(),t.find(".js-note-text").data("autosave").reset(),t.prev(".discussion-reply-holder").show(),e.is(".js-temp-notes-holder")?e.remove():t.remove()}cancelDiscussionForm(t){t.preventDefault();const e=u()(t.target).closest(".js-discussion-note-form");if(0===u()(t.target).closest(".discussion-notes").length){const n=e.closest(".diff-file");if(n.length>0){const e=new CustomEvent("blur.imageDiff",{detail:t});n[0].dispatchEvent(e)}}return this.removeDiscussionNoteForm(e)}updateFormAttachment(){const t=u()(this).closest("form"),e=u()(this).val().replace(/^.*[\\\/]/,"");return t.find(".js-attachment-filename").text(e)}visibilityChange(){return this.refresh()}updateTargetButtons(t){let e,n;const i=u()(t.target),s=i.parents("form"),o=s.find(".js-note-target-reopen"),r=s.find(".js-note-target-close");i.val().trim().length>0?(n=o.attr("data-alternative-text"),e=r.attr("data-alternative-text"),o.text()!==n&&o.text(n),r.text()!==e&&r.text(e),o.is(":not(.btn-comment-and-reopen)")&&o.addClass("btn-comment-and-reopen"),r.is(":not(.btn-comment-and-close)")&&r.addClass("btn-comment-and-close")):(n=o.data("originalText"),e=r.data("originalText"),o.text()!==n&&o.text(n),r.text()!==e&&r.text(e),o.is(".btn-comment-and-reopen")&&o.removeClass("btn-comment-and-reopen"),r.is(".btn-comment-and-close")&&r.removeClass("btn-comment-and-close"))}putEditFormInPlace(t){const e=u()(this.getEditFormSelector(t)),n=t.closest(".note");e.insertAfter(n.find(".note-text"));const i=n.find(".original-note-content"),s=i.text().trim(),o=i.data("postUrl"),r=i.data("targetId"),a=i.data("targetType");this.glForm=new S.a(e.find("form"),this.enableGFM),e.find("form").attr("action","".concat(o,"?html=true")).attr("data-remote","true"),e.find(".js-form-target-id").val(r),e.find(".js-form-target-type").val(a),e.find(".js-note-text").focus().val(s),e.find(".js-md-write-button").trigger("click"),e.find(".referenced-users").hide()}putConflictEditWarningInPlace(t,e){if(0===e.find(".js-conflict-edit-warning").length){const n='<a href="#note_'.concat(t.id,'" target="_blank" rel="noopener noreferrer">');u()('<div class="js-conflict-edit-warning alert alert-danger">\n        '.concat(Object(L.f)(Object(L.e)("Notes|This comment has changed since you started editing, please review the %{open_link}updated comment%{close_link} to ensure information is not lost"),{open_link:n,close_link:"</a>"}),"\n      </div>")).insertAfter(e.find(".note-text"))}}updateNotesCount(t){return this.notesCountBadge.text(parseInt(this.notesCountBadge.text(),10)+t)}static renderPlaceholderComponent(t){const e=t.find(".js-code-placeholder").get(0);new f.default({el:e,components:{GlSkeletonLoading:a.a},render:t=>t("gl-skeleton-loading")})}static renderDiffContent(t,e){const{discussion_html:n}=e,i=u()(n).find(".line_holder");i.addClass("fade-in"),t.find(".diff-content > table > tbody").prepend(i);const s=t.find(".file-holder");t.find(".line-holder-placeholder").remove(),Object(g.a)(s)}onClickRetryLazyLoad(t){const e=u()(t.currentTarget);return e.prop("disabled",!0),this.loadLazyDiff(t).then((function(){e.prop("disabled",!1)}))}loadLazyDiff(t){const e=u()(t.currentTarget).closest(".js-toggle-container");if(P.renderPlaceholderComponent(e),e.find(".js-toggle-lazy-diff").removeClass("js-toggle-lazy-diff"),0===e.find("tbody").length)return;const n=e.find(".file-holder").data("linesPath"),i=e.find(".js-error-lazy-load-diff"),s=e.find(".js-success-lazy-load");return n?T.a.get(n).then((function(t){let{data:n}=t;s.removeClass("hidden"),i.addClass("hidden"),P.renderDiffContent(e,n)})).catch((function(){s.addClass("hidden"),i.removeClass("hidden")})):Promise.resolve()}toggleCommitList(t){const e=u()(t.currentTarget),n=e.siblings(".system-note-commit-list"),i=e.find("svg.js-chevron-up"),s=e.find("svg.js-chevron-down");i.toggleClass("gl-display-none"),s.toggleClass("gl-display-none"),n.toggleClass("hide-shade")}collapseLongCommitList(){const t=u()("#notes-list").find("li.system-note").has("ul");u.a.each(t,(function(t,e){const n=u()(e),i=n.find(".note-text").find("p").first().text().replace(":","");n.find(".note-header .system-note-message").html(i),n.find("li").length>F?(n.find(".note-text").addClass("system-note-commit-list"),n.find(".system-note-commit-list-toggler").show()):n.find(".note-text").addClass("system-note-commit-list hide-shade")}))}addFlash(){this.flashContainer=Object(C.b)(...arguments)}clearFlash(){this.flashContainer&&(this.flashContainer.style.display="none",this.flashContainer=null)}cleanForm(t){return t.find(".js-comment-type-dropdown").removeClass("btn-group"),t.find(".dropdown-menu").remove(),t}static isNewNote(t,e){return-1===u.a.inArray(t.id,e)}static isUpdatedNote(t,e){return I(t.note.trim())!==I(e.find(".original-note-content").first().text().trim())}static checkMergeRequestStatus(){"merge_requests"===Object(N.o)(1)&&gl.mrWidget&&gl.mrWidget.checkStatus()}static animateAppendNote(t,e){const n=u()(t);return n.addClass("fade-in-full").renderGFM(),e.append(n),n}static animateUpdateNote(t,e){const n=u()(t);return n.addClass("fade-in").renderGFM(),e.replaceWith(n),n}getFormData(t){const e=t.find(".js-note-text").val();return{formData:t.serialize(),formContent:r()(e),formAction:t.attr("action"),formContentOriginal:e}}hasQuickActions(t){return O.test(t)}stripQuickActions(t){return t.replace(O,"").trim()}getQuickActionDescription(t){let e;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).filter((function(e){return new RegExp("/".concat(e.name)).test(t)}));if(n&&n.length)if(n.length>1)e=Object(L.a)("Applying multiple commands");else{const t=n[0].description.toLowerCase();e=Object(L.f)(Object(L.a)("Applying command to %{commandDescription}"),{commandDescription:t})}else e=Object(L.a)("Applying command");return e}createPlaceholderNote(t){let{formContent:e,uniqueId:n,isDiscussionNote:i,currentUsername:s,currentUserFullname:o,currentUserAvatar:a}=t;const l=i?"discussion":"",c=u()('<li id="'.concat(n,'" class="note being-posted fade-in-half timeline-entry">\n         <div class="timeline-entry-inner">\n            <div class="timeline-icon">\n               <a href="/').concat(r()(s),'">\n                 <img class="avatar s40" src="').concat(a,'" />\n               </a>\n            </div>\n            <div class="timeline-content ').concat(l,'">\n               <div class="note-header">\n                  <div class="note-header-info">\n                     <a href="/').concat(r()(s),'">\n                       <span class="d-none d-sm-inline-block bold">').concat(r()(s),'</span>\n                       <span class="note-headline-light">').concat(r()(s),'</span>\n                     </a>\n                  </div>\n               </div>\n               <div class="note-body">\n                 <div class="note-text">\n                   <p>').concat(e,"</p>\n                 </div>\n               </div>\n            </div>\n         </div>\n      </li>"));return c.find(".d-none.d-sm-inline-block").text(r()(o)),c.find(".note-headline-light").text("@".concat(r()(s))),c}createPlaceholderSystemNote(t){let{formContent:e,uniqueId:n}=t;return u()('<li id="'.concat(n,'" class="note system-note timeline-entry being-posted fade-in-half">\n         <div class="timeline-entry-inner">\n           <div class="timeline-content">\n             <i>').concat(e,"</i>\n           </div>\n         </div>\n       </li>"))}postComment(t){var e=this;t.preventDefault();const n=u()(t.target);n.prop("disabled",!0);let i=n.parents("form");const o=i.find(".js-note-target-close"),r="discussion"===n.parent().find("li.droplab-item-selected").attr("id"),a=i.hasClass("js-main-target-form"),l=i.hasClass("js-discussion-note-form"),c=n.hasClass("js-comment-resolve-button"),{formData:d,formContent:h,formAction:m,formContentOriginal:f}=this.getFormData(i);let g,v,b,j,y=!1;return l?b=i.parent(".discussion-notes").find(".notes"):a&&(b=u()("ul.main-notes-list")),c&&i.find(".js-comment-submit-button").disable(),j=h,this.glForm.supportsQuickActions&&this.hasQuickActions(h)&&(j=this.stripQuickActions(h),y=!0),j&&(g=s()("tempNote_"),b.append(this.createPlaceholderNote({formContent:j,uniqueId:g,isDiscussionNote:r,currentUsername:gon.current_username,currentUserFullname:gon.current_user_fullname,currentUserAvatar:gon.current_user_avatar_url}))),y&&(v=s()("tempSystemNote_"),b.append(this.createPlaceholderSystemNote({formContent:this.getQuickActionDescription(h,p.a.get(gl.GfmAutoComplete.dataSources.commands)),uniqueId:v}))),b.length&&(a?this.resetMainTargetForm(t):l&&this.removeDiscussionNoteForm(i)),o.text(o.data("originalText")),T.a.post("".concat(m,"?html=true"),d).then((function(s){const o=s.data;n.prop("disabled",!1),b.find("#".concat(g)).remove();const r=i.closest(".diff-file");if(r.length>0){const e=new CustomEvent("blur.imageDiff",{detail:t});r[0].dispatchEvent(e)}if(y&&i.find("textarea.js-note-text").trigger("clear-commands-cache.atwho"),e.clearFlashWrapper(),l){b.find(".flash-container").remove(),c&&i.attr("data-discussion-id",n.data("discussionId")).attr("data-resolve-all","true").attr("data-project-path",n.data("projectPath"));const t=0===b.length;if(e.addDiscussionNote(i,o,t),t){const t=i.find("#note_position").val();if(r.length>0&&t.length>0){const{x:e,y:n,width:i,height:s}=JSON.parse(t),a=new CustomEvent("addBadge.imageDiff",{detail:{x:e,y:n,width:i,height:s,noteId:"note_".concat(o.id),discussionId:o.discussion_id}});r[0].dispatchEvent(a)}}b.length&&b.append('<div class="flash-container" style="display: none;"></div>')}else a&&(e.addNote(i,o),e.reenableTargetFormSubmitButton(t));o.commands_changes&&e.handleQuickActions(o),i.trigger("ajax:success",[o])})).catch((function(){b.find("#".concat(g)).remove(),n.prop("disabled",!1);const s=new CustomEvent("blur.imageDiff",{detail:t}),o=i.closest(".diff-file");if(o.length&&o[0].dispatchEvent(s),y&&b.find("#".concat(v)).remove(),l&&b.length){const t=b.parent().find(".js-discussion-reply-button");e.replyToDiscussionNote(t[0]),i=b.parent().find("form")}i.find(".js-note-text").val(f),e.reenableTargetFormSubmitButton(t),e.addNoteError(i)}))}updateComment(t){var e=this;t.preventDefault();const n=u()(t.target).parents("form"),i=n.find(".js-note-target-close"),s=n.parents(".note.is-editing"),o=s.find(".js-task-list-container").find(".note-text"),{formData:a,formContent:l,formAction:c}=this.getFormData(n),d=o.html();return o.html(l),s.removeClass("is-editing fade-in-full").addClass("being-posted fade-in-half"),s.find(".note-headline-meta a").html('<span class="spinner align-text-bottom"></span>'),T.a.post("".concat(c,"?html=true"),a).then((function(t){let{data:n}=t;e.updateNote(n,s)})).catch((function(){o.html(r()(d)),s.removeClass("being-posted fade-in"),s.find(".gl-spinner").remove(),e.updateNoteError()})),i.text(i.data("originalText"))}}window.Notes=P},xy9X:function(t,e,n){"use strict";e.a={computed:{validity:{cache:!1,get:function(){return this.$refs.input.validity}},validationMessage:{cache:!1,get:function(){return this.$refs.input.validationMessage}},willValidate:{cache:!1,get:function(){return this.$refs.input.willValidate}}},methods:{setCustomValidity:function(){var t;return(t=this.$refs.input).setCustomValidity.apply(t,arguments)},checkValidity:function(){var t;return(t=this.$refs.input).checkValidity.apply(t,arguments)},reportValidity:function(){var t;return(t=this.$refs.input).reportValidity.apply(t,arguments)}}}}}]);
//# sourceMappingURL=commons-pages.projects.commit.show-pages.projects.snippets.show-pages.snippets.show.6d439bf4.chunk.js.map